{"version":3,"sources":["bilibili/danmaku_api/display.ts"],"names":["Display","Display.constructor","Display.fullScreenWidth","Display.fullScreenHeight","Display.width","Display.height","Display.createMatrix","Display.createPoint","Display.createComment","Display.createShape","Display.createCanvas","Display.createButton","Display.createGlowFilter","Display.createBlurFilter","Display.toIntVector","Display.toUIntVector","Display.toNumberVector","Display.createVector3D","Display.createMatrix3D","Display.createColorTransform","Display.createTextFormat","Display.createGraphic","Display.projectVector","Display.projectVectors"],"mappings":"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","file":"bilibili/danmaku_api/Display.js","sourcesContent":["/**\r\n * Created by MIC on 2015/12/29.\r\n */\r\n\r\nimport {BiliBiliDanmakuApiContainer} from \"../BiliBiliDanmakuApiContainer\";\r\nimport {BiliBiliDamakuApiObject} from \"./BiliBiliDamakuApiObject\";\r\nimport {DCShape} from \"../../danmaku/scripted/dco/DCShape\";\r\nimport {IGeneralCreateParams} from \"./data_types/IGeneralCreateParams\";\r\nimport {ICommentButtonCreateParams} from \"./data_types/ICommentButtonCreateParams\";\r\nimport {CommentField} from \"./CommentField\";\r\nimport {Matrix} from \"../../../lib/glantern/src/glantern/flash/geom/Matrix\";\r\nimport {Point} from \"../../../lib/glantern/src/glantern/flash/geom/Point\";\r\nimport {TextField} from \"../../../lib/glantern/src/glantern/flash/text/TextField\";\r\nimport {NotImplementedError} from \"../../../lib/glantern/lib/glantern-utils/src/NotImplementedError\";\r\nimport {BitmapFilterQuality} from \"../../../lib/glantern/src/glantern/flash/filters/BitmapFilterQuality\";\r\nimport {GlowFilter} from \"../../../lib/glantern/src/glantern/flash/filters/GlowFilter\";\r\nimport {BlurFilter} from \"../../../lib/glantern/src/glantern/flash/filters/BlurFilter\";\r\nimport {Vector3D} from \"../../../lib/glantern/src/glantern/flash/geom/Vector3D\";\r\nimport {Matrix3D} from \"../../../lib/glantern/src/glantern/flash/geom/Matrix3D\";\r\nimport {ColorTransform} from \"../../../lib/glantern/src/glantern/flash/geom/ColorTransform\";\r\nimport {TextFormat} from \"../../../lib/glantern/src/glantern/flash/text/TextFormat\";\r\nimport {Graphics} from \"../../../lib/glantern/src/glantern/flash/display/Graphics\";\r\nimport {GLUtil} from \"../../../lib/glantern/lib/glantern-utils/src/GLUtil\";\r\n\r\nexport class Display extends BiliBiliDamakuApiObject {\r\n\r\n    constructor(apiContainer:BiliBiliDanmakuApiContainer) {\r\n        super(apiContainer);\r\n    }\r\n\r\n    get fullScreenWidth():number {\r\n        return window.screen.width;\r\n    }\r\n\r\n    get fullScreenHeight():number {\r\n        return window.screen.height;\r\n    }\r\n\r\n    get width():number {\r\n        return this.apiContainer.bulletproof.view.width;\r\n    }\r\n\r\n    get height():number {\r\n        return this.apiContainer.bulletproof.view.height;\r\n    }\r\n\r\n    createMatrix(a:number = 1, b:number = 0, c:number = 1, d:number = 1, tx:number = 0, ty:number = 0):Matrix {\r\n        return new Matrix(a, b, c, d, tx, ty);\r\n    }\r\n\r\n    createPoint(x:number = 0, y:number = 0):Point {\r\n        return new Point(x, y);\r\n    }\r\n\r\n    createComment(text:string, params:IGeneralCreateParams):TextField {\r\n        var danmaku = this.apiContainer.danmaku;\r\n        var textField = new CommentField(danmaku.stage, danmaku, params, this.__getExtraCreateParams());\r\n        textField.text = text;\r\n        textField.textColor = 0xffffff;\r\n        // Use \"Arial\" as default font for users outside China.\r\n        textField.defaultTextFormat.font = \"SimHei\";\r\n        danmaku.addChild(textField);\r\n        return textField;\r\n    }\r\n\r\n    createShape(params:IGeneralCreateParams):DCShape {\r\n        var danmaku = this.apiContainer.danmaku;\r\n        var shape = new DCShape(danmaku.stage, danmaku, params, this.__getExtraCreateParams());\r\n        danmaku.addChild(shape);\r\n        return shape;\r\n    }\r\n\r\n    createCanvas(params:IGeneralCreateParams):any {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    createButton(text:string, params:ICommentButtonCreateParams):any {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    createGlowFilter(color:number = 0xff0000, alpha:number = 1.0, blurX:number = 6.0,\r\n                     blurY:number = 6.0, strength:number = 2, quality:number = BitmapFilterQuality.LOW,\r\n                     inner:boolean = false, knockout:boolean = false):GlowFilter {\r\n        var renderer = this.apiContainer.danmaku.stage.worldRenderer;\r\n        return new GlowFilter(renderer.filterManager, color, alpha, blurX, blurY, strength, quality, inner, knockout);\r\n    }\r\n\r\n    createBlurFilter(blurX:number = 4.0, blurY:number = 4.0, quality:number = BitmapFilterQuality.LOW):BlurFilter {\r\n        var renderer = this.apiContainer.danmaku.stage.worldRenderer;\r\n        return new BlurFilter(renderer.filterManager, blurX, blurY, quality);\r\n    }\r\n\r\n    toIntVector(array:number[]):number[] {\r\n        // jabbany\r\n        Object.defineProperty(array, \"as3Type\", {\r\n            get: function () {\r\n                return \"Vector.<int>\";\r\n            }\r\n        });\r\n        return array;\r\n    }\r\n\r\n    toUIntVector(array:number[]):number[] {\r\n        // jabbany\r\n        Object.defineProperty(array, \"as3Type\", {\r\n            get: function () {\r\n                return \"Vector.<uint>\";\r\n            }\r\n        });\r\n        return array;\r\n    }\r\n\r\n    toNumberVector(array:number[]):number[] {\r\n        // jabbany\r\n        Object.defineProperty(array, \"as3Type\", {\r\n            get: function () {\r\n                return \"Vector.<number>\";\r\n            }\r\n        });\r\n        return array;\r\n    }\r\n\r\n    createVector3D(x:number = 0, y:number = 0, z:number = 0, w:number = 0):Vector3D {\r\n        return new Vector3D(x, y, z, w);\r\n    }\r\n\r\n    createMatrix3D(a:number[] = null):Matrix3D {\r\n        return new Matrix3D(a);\r\n    }\r\n\r\n    createColorTransform():ColorTransform {\r\n        return new ColorTransform();\r\n    }\r\n\r\n    createTextFormat():TextFormat {\r\n        return new TextFormat();\r\n    }\r\n\r\n    createGraphic():Graphics {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    projectVector(matrix:Matrix3D, vector:Vector3D):Vector3D {\r\n        return matrix.transformVector(vector);\r\n    }\r\n\r\n    projectVectors(matrix:Matrix3D, vertices:number[], projectedVertices:number[], uvts:number[]):void {\r\n        while (projectedVertices.length > 0) {\r\n            projectedVertices.pop();\r\n        }\r\n        if (vertices.length % 3 != 0) {\r\n            GLUtil.trace(\"Display.projectVectors input vertex Vector must be a multiple of 3.\");\r\n            return;\r\n        }\r\n        var transformed:number[] = [];\r\n        matrix.transformVectors(vertices, transformed);\r\n        for (var i = 0; i < transformed.length / 3; i++) {\r\n            var x = transformed[i * 3], y = transformed[i * 3 + 1];\r\n            projectedVertices.push(x, y);\r\n        }\r\n    }\r\n\r\n}\r\n"],"sourceRoot":"/source/"}
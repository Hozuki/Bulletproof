{"version":3,"sources":["bilibili/danmaku_api/player.ts"],"names":["Player","Player.constructor","Player.play","Player.pause","Player.seek","Player.jump","Player.state","Player.time","Player.commentTrigger","Player.keyTrigger","Player.setMask","Player.createSound","Player.commentList","Player.refreshRate","Player.width","Player.height","Player.videoWidth","Player.videoHeight"],"mappings":"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","file":"bilibili/danmaku_api/Player.js","sourcesContent":["/**\r\n * Created by MIC on 2016/1/7.\r\n */\r\n\r\nimport {BiliBiliDanmakuApiContainer} from \"../BiliBiliDanmakuApiContainer\";\r\nimport {BiliBiliDamakuApiObject} from \"./BiliBiliDamakuApiObject\";\r\nimport {NotImplementedError} from \"../../../lib/glantern/src/_util/NotImplementedError\";\r\nimport {DisplayObject} from \"../../../lib/glantern/src/flash/display/DisplayObject\";\r\nimport {CommentData} from \"./CommentData\";\r\nimport {Sound} from \"../../../lib/glantern/src/flash/media/Sound\";\r\nimport {_util} from \"../../../lib/glantern/src/_util/_util\";\r\nimport {VideoPlayerBase} from \"../../interactive/video/VideoPlayerBase\";\r\nimport {VideoPlayerState} from \"../../interactive/video/VideoPlayerState\";\r\nimport {PlayerState} from \"./PlayerState\";\r\nimport {DanmakuProviderBase} from \"../../danmaku/DanmakuProviderBase\";\r\n\r\nexport class Player extends BiliBiliDamakuApiObject {\r\n\r\n    constructor(apiContainer:BiliBiliDanmakuApiContainer) {\r\n        super(apiContainer);\r\n        this._videoPlayer = apiContainer.bulletproof.videoPlayer;\r\n    }\r\n\r\n    play():void {\r\n        if (this._videoPlayer !== null) {\r\n            this._videoPlayer.play();\r\n        }\r\n    }\r\n\r\n    pause():void {\r\n        if (this._videoPlayer !== null) {\r\n            this._videoPlayer.pause();\r\n        }\r\n    }\r\n\r\n    seek(offset:number):void {\r\n        if (this._videoPlayer !== null) {\r\n            this._videoPlayer.currentTime = offset;\r\n        }\r\n    }\r\n\r\n    jump(av:string, page:number = 1, newWindow:boolean = false):void {\r\n        var url = _util.formatString(\"http://www.bilibili.com/video/{0}/index_{1}.html\", av, page);\r\n        if (newWindow) {\r\n            window.open(url, \"_blank\");\r\n        } else {\r\n            window.location.assign(url);\r\n        }\r\n    }\r\n\r\n    get state():string {\r\n        if (this._videoPlayer === null) {\r\n            return PlayerState.INVALID;\r\n        } else {\r\n            var state = this._videoPlayer.state;\r\n            switch (state) {\r\n                case VideoPlayerState.Playing:\r\n                case VideoPlayerState.Seeking:\r\n                    return PlayerState.PLAYING;\r\n                case VideoPlayerState.Paused:\r\n                    return PlayerState.PAUSE;\r\n                case VideoPlayerState.Created:\r\n                case VideoPlayerState.Initialized:\r\n                case VideoPlayerState.Loaded:\r\n                case VideoPlayerState.Stopped:\r\n                    return PlayerState.STOP;\r\n                default:\r\n                    return PlayerState.INVALID;\r\n            }\r\n        }\r\n    }\r\n\r\n    get time():number {\r\n        return this.apiContainer.bulletproof.timeElapsed;\r\n    }\r\n\r\n    commentTrigger(f:(cd:CommentData) => void, timeout:number = 1000):number {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    keyTrigger(f:(key:number) => void, timeout:number = 1000, up:boolean = false):number {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    setMask(obj:DisplayObject):void {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    createSound(t:string, onLoad:Function = null):Sound {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    get commentList():CommentData[] {\r\n        var comments:CommentData[] = [];\r\n        var providers = this.apiContainer.bulletproof.danmakuCoordinator.getDanmakuProviders();\r\n        var provider:DanmakuProviderBase;\r\n        for (var j = 0; j < providers.length; ++j) {\r\n            provider = providers[j];\r\n            for (var i = 0; i < provider.fullDanmakuList.length; ++i) {\r\n                comments.push(provider.fullDanmakuList[i].getCommentData());\r\n            }\r\n        }\r\n        return comments;\r\n    }\r\n\r\n    get refreshRate():number {\r\n        return 1 / this.apiContainer.bulletproof.fps;\r\n    }\r\n\r\n    set refreshRate(v:number) {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    get width():number {\r\n        return this.apiContainer.bulletproof.stage.stageWidth;\r\n    }\r\n\r\n    get height():number {\r\n        return this.apiContainer.bulletproof.stage.stageHeight;\r\n    }\r\n\r\n    get videoWidth():number {\r\n        return this._videoPlayer !== null ? this._videoPlayer.videoWidth : 0;\r\n    }\r\n\r\n    get videoHeight():number {\r\n        return this._videoPlayer !== null ? this._videoPlayer.videoHeight : 0;\r\n    }\r\n\r\n    private _videoPlayer:VideoPlayerBase = null;\r\n\r\n}\r\n"],"sourceRoot":"/source/"}
{"version":3,"sources":["bulletproof.ts"],"names":["Bulletproof","Bulletproof.constructor","Bulletproof.initialize","Bulletproof.startAnimation","Bulletproof.stopAnimation","Bulletproof.dispose","Bulletproof.danmakuCoordinator","Bulletproof.isAnimationRunning","Bulletproof.timeElapsed","Bulletproof.SIMPLE_DANMAKU_LIFE_TIME","Bulletproof.CODE_DANMAKU_LIFE_TIME","Bulletproof.___updateComponents"],"mappings":"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","file":"Bulletproof.js","sourcesContent":["/**\r\n * Created by MIC on 2015/12/28.\r\n */\r\n\r\nimport {GLantern} from \"../lib/glantern/src/GLantern\";\r\nimport {DanmakuCoordinator} from \"./danmaku/DanmakuCoordinator\";\r\nimport {CodeDanmakuProvider} from \"./danmaku/code/CodeDanmakuProvider\";\r\nimport {DanmakuProviderBase} from \"./danmaku/DanmakuProviderBase\";\r\nimport {NotImplementedError} from \"../lib/glantern/src/_util/NotImplementedError\";\r\n\r\nexport class Bulletproof extends GLantern {\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    initialize(width:number, height:number):void {\r\n        super.initialize(width, height);\r\n        this.attachUpdateFunction(this.__updateComponents.bind(this));\r\n        var coordinator = new DanmakuCoordinator(this);\r\n        this._coordinator = coordinator;\r\n\r\n        var provider:DanmakuProviderBase;\r\n        provider = new CodeDanmakuProvider(coordinator);\r\n        coordinator.addDanmakuProvider(provider);\r\n    }\r\n\r\n    startAnimation():void {\r\n        if (!this.isAnimationRunning) {\r\n            this._lastUpdatedTime = Date.now();\r\n        }\r\n        super.startAnimation();\r\n    }\r\n\r\n    stopAnimation():void {\r\n        super.stopAnimation();\r\n    }\r\n\r\n    dispose():void {\r\n        this._coordinator.dispose();\r\n        this._coordinator = null;\r\n        super.dispose();\r\n    }\r\n\r\n    get danmakuCoordinator():DanmakuCoordinator {\r\n        return this._coordinator;\r\n    }\r\n\r\n    get isAnimationRunning():boolean {\r\n        return this._isRunning;\r\n    }\r\n\r\n    get timeElapsed():number {\r\n        return this._totalElapsedTime;\r\n    }\r\n\r\n    static get SIMPLE_DANMAKU_LIFE_TIME():number {\r\n        // 10 seconds\r\n        return 10;\r\n    }\r\n\r\n    static get CODE_DANMAKU_LIFE_TIME():number {\r\n        return Number.MAX_VALUE;\r\n    }\r\n\r\n    protected __updateComponents():void {\r\n        var now = Date.now();\r\n        if (this._lastUpdatedTime > 0) {\r\n            this._totalElapsedTime += now - this._lastUpdatedTime;\r\n            this._lastUpdatedTime = now;\r\n        }\r\n        this._coordinator.update();\r\n    }\r\n\r\n    protected _lastUpdatedTime:number = -1;\r\n    protected _totalElapsedTime:number = 0;\r\n    protected _coordinator:DanmakuCoordinator = null;\r\n\r\n}\r\n"],"sourceRoot":"/source/"}
{"version":3,"sources":["danmaku/simple/simpledanmaku.ts"],"names":["SimpleDanmaku","SimpleDanmaku.constructor","SimpleDanmaku.dispose","SimpleDanmaku.danmakuKind","SimpleDanmaku.layoutManager","SimpleDanmaku.danmakuProvider","SimpleDanmaku.getContent","SimpleDanmaku.getText","SimpleDanmaku.initialize","SimpleDanmaku.bulletproof","SimpleDanmaku.bornTime","SimpleDanmaku.lifeTime","SimpleDanmaku.createParams","SimpleDanmaku.textHeight","SimpleDanmaku.textWidth"],"mappings":"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","file":"danmaku/simple/SimpleDanmaku.js","sourcesContent":["/**\r\n * Created by MIC on 2015/12/28.\r\n */\r\n\r\nimport {DanmakuKind} from \"../DanmakuKind\";\r\nimport {SimpleDanmakuLayoutManager} from \"./SimpleDanmakuLayoutManager\";\r\nimport {Stage} from \"../../../lib/glantern/src/flash/display/Stage\";\r\nimport {DisplayObjectContainer} from \"../../../lib/glantern/src/flash/display/DisplayObjectContainer\";\r\nimport {SimpleDanmakuProvider} from \"./SimpleDanmakuProvider\";\r\nimport {Bulletproof} from \"../../Bulletproof\";\r\nimport {WebGLRenderer} from \"../../../lib/glantern/src/webgl/WebGLRenderer\";\r\nimport {SimpleDanmakuType} from \"./SimpleDanamkuType\";\r\nimport {IDanmaku} from \"../IDanmaku\";\r\nimport {Point} from \"../../../lib/glantern/src/flash/geom/Point\";\r\nimport {ISimpleDanmakuCreateParams} from \"./ISimpleDanmakuCreateParams\";\r\nimport {BulletproofConfig} from \"../../BulletproofConfig\";\r\n\r\nexport class SimpleDanmaku implements IDanmaku {\r\n\r\n    constructor(layoutManager:SimpleDanmakuLayoutManager, createParams:ISimpleDanmakuCreateParams) {\r\n        this._layoutManager = layoutManager;\r\n        this._danmakuProvider = layoutManager.danmakuProvider;\r\n        this._bulletproof = layoutManager.bulletproof;\r\n        this._createParams = createParams;\r\n    }\r\n\r\n    dispose():void {\r\n    }\r\n\r\n    get danmakuKind():DanmakuKind {\r\n        return DanmakuKind.Simple;\r\n    }\r\n\r\n    get layoutManager():SimpleDanmakuLayoutManager {\r\n        return this._layoutManager;\r\n    }\r\n\r\n    get danmakuProvider():SimpleDanmakuProvider {\r\n        return this._danmakuProvider;\r\n    }\r\n\r\n    getContent():string {\r\n        return this._content;\r\n    }\r\n\r\n    getText():string {\r\n        return this._content;\r\n    }\r\n\r\n    initialize(content:string, time:number):void {\r\n        this._content = content;\r\n        this._bornTime = typeof this.createParams.bornTime === \"number\" ? this.createParams.bornTime : time;\r\n    }\r\n\r\n    get bulletproof():Bulletproof {\r\n        return this._bulletproof;\r\n    }\r\n\r\n    get bornTime():number {\r\n        return this._bornTime;\r\n    }\r\n\r\n    get lifeTime():number {\r\n        return BulletproofConfig.simpleDanmakuLifeTimeSecs;\r\n    }\r\n\r\n    get createParams():ISimpleDanmakuCreateParams {\r\n        return this._createParams;\r\n    }\r\n\r\n    get textHeight():number {\r\n        if (this._textHeight < 0) {\r\n            this._textHeight = this.createParams.fontSize * 1.5;\r\n        }\r\n        return this._textHeight;\r\n    }\r\n\r\n    get textWidth():number {\r\n        if (this._textWidth < 0) {\r\n            var context2D = this.danmakuProvider.danmakuLayer.context2D;\r\n            context2D.font = this.createParams.fontSize.toString() + \"pt \\\"\" + this.createParams.fontName + \"\\\"\";\r\n            this._textWidth = context2D.measureText(this.getText()).width;\r\n        }\r\n        return this._textWidth;\r\n    }\r\n\r\n    /**\r\n     * Gets/sets whether the Y position of this {@link SimpleDanmaku} is set. If the it is set, the {@link SimpleDanmakuLayoutManager}\r\n     * should only change the value of X position since sudden modification to Y position will confuse audiences.\r\n     * However, considering that size of the stage may change, simple danmakus fixed at bottom (bottom, bottom left,\r\n     * bottom right) should recalculate their Y positions to fit in the change.\r\n     * @type {Boolean}\r\n     */\r\n    isYPositionSet:boolean = false;\r\n\r\n    /**\r\n     * X coordinate of the top left point of this {@link SimpleDanmaku}.\r\n     * @type {Number}\r\n     */\r\n    x:number = 0;\r\n\r\n    /**\r\n     * Y coordinate of the top left point of this {@link SimpleDanmaku}.\r\n     * @type {Number}\r\n     */\r\n    y:number = 0;\r\n\r\n    visible:boolean = false;\r\n\r\n    displaying:boolean = false;\r\n\r\n    private _content:string = null;\r\n    private _bornTime:number = 0;\r\n    private _bulletproof:Bulletproof = null;\r\n    private _layoutManager:SimpleDanmakuLayoutManager;\r\n    private _danmakuProvider:SimpleDanmakuProvider;\r\n    private _createParams:ISimpleDanmakuCreateParams = null;\r\n    private _textWidth:number = -1;\r\n    private _textHeight:number = -1;\r\n\r\n}\r\n"],"sourceRoot":"/source/"}